var PhotoSphereViewer=function(e){var t,o=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},i=function(){var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl"))},n=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},r=function(e,t,o){return Math.max(t,Math.min(o,e))},a=function(e,t,o,i){var n=o-e,r=i-t;return n*n+r*r},s=function(e,t){return t=void 0!==t?!!t:!1,t&&e==2*Math.PI?2*Math.PI:e-2*Math.floor(e/(2*Math.PI))*Math.PI};this.load=function(){if(Ie.innerHTML="",it&&1===it.nodeType)Ie.appendChild(it);else if(it&&"string"==typeof it)Ie.innerHTML=it;else if(ot){var e=document.createElement("img");e.setAttribute("src",ot),e.setAttribute("alt",tt),Ie.appendChild(e)}else Ie.textContent=tt;return He=document.createElement("div"),He.style.width="100%",He.style.height="100%",He.style.position="relative",He.style.overflow="hidden",o()?void 0===window.THREE?void console.log("PhotoSphereViewer: Three.js is not loaded."):(Se={width:0,height:0,ratio:0},void(Ue&&!Be.match(/^data:image\/[a-z]+;base64/)?c():u())):void(Ie.textContent="Canvas is not supported, update your browser!")},this["delete"]=function(){t&&(t.material.map.dispose(),Le.remove(t))},this.changePanorama=function(e){Be=e};var l=function(e){for(var t=0,o=0,i="";-1!=(t=e.indexOf("<x:xmpmeta",o))&&-1!=(o=e.indexOf("</x:xmpmeta>",t));)if(i=e.substring(t,o),-1!=i.indexOf("GPano:"))return i;return""},d=function(e,t){var o=e.indexOf("GPano:"+t)+t.length+8,i=e.indexOf('"',o);return-1==i&&(o=e.indexOf("GPano:"+t)+t.length+7,i=e.indexOf("<",o)),e.substring(o,i)},c=function(){var e=null;if(window.XMLHttpRequest)e=new XMLHttpRequest;else{if(!window.ActiveXObject)return void(Ie.textContent="XHR is not supported, update your browser!");try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){e=new ActiveXObject("Microsoft.XMLHTTP")}}e.onreadystatechange=function(){if(4==e.readyState&&200==e.status){var t=l(e.responseText);if(!t.length)return void u();Ze={full_width:parseInt(d(t,"FullPanoWidthPixels")),full_height:parseInt(d(t,"FullPanoHeightPixels")),cropped_width:parseInt(d(t,"CroppedAreaImageWidthPixels")),cropped_height:parseInt(d(t,"CroppedAreaImageHeightPixels")),cropped_x:parseInt(d(t,"CroppedAreaLeftPixels")),cropped_y:parseInt(d(t,"CroppedAreaTopPixels"))},et=!0,u()}},e.open("GET",Be,!0),e.send(null)},u=function(){var e=new Image;e.onload=function(){var t={full_width:e.width,full_height:e.height,cropped_width:e.width,cropped_height:e.height,cropped_x:null,cropped_y:null};if(360!=Qe.horizontal_fov||180!=Qe.vertical_fov){if(Ze.cropped_width=t.cropped_width,Ze.cropped_height=t.cropped_height,Ze.full_width=t.full_width,Ze.full_height=t.full_height,360!=Qe.horizontal_fov){var o=Qe.horizontal_fov/360;Ze.full_width=Ze.cropped_width/o}if(180!=Qe.vertical_fov){var n=Qe.vertical_fov/180;Ze.full_height=Ze.cropped_height/n}}else{for(var r in Ze)null===Ze[r]&&void 0!==t[r]&&(Ze[r]=t[r]);if(et){if(Ze.cropped_width!=t.cropped_width){var a=t.cropped_width/Ze.cropped_width;Ze.cropped_width=t.cropped_width,Ze.full_width*=a,Ze.cropped_x*=a}if(Ze.cropped_height!=t.cropped_height){var s=t.cropped_height/Ze.cropped_height;Ze.cropped_height=t.cropped_height,Ze.full_height*=s,Ze.cropped_y*=s}}}null===Ze.cropped_x&&(Ze.cropped_x=(Ze.full_width-Ze.cropped_width)/2),null===Ze.cropped_y&&(Ze.cropped_y=(Ze.full_height-Ze.cropped_height)/2);var l=2048;if(i()){var d=document.createElement("canvas"),c=d.getContext("webgl");l=c.getParameter(c.MAX_TEXTURE_SIZE)}var u=Math.min(Ze.full_width,l),p=u/Ze.full_width;Ze.full_width=u,Ze.cropped_width*=p,Ze.cropped_x*=p,e.width=Ze.cropped_width,Ze.full_height*=p,Ze.cropped_height*=p,Ze.cropped_y*=p,e.height=Ze.cropped_height;var g=document.createElement("canvas");g.width=Ze.full_width,g.height=Ze.full_height;var v=g.getContext("2d");v.drawImage(e,Ze.cropped_x,Ze.cropped_y,Ze.cropped_width,Ze.cropped_height),h(g.toDataURL("image/jpeg"))},Ke&&!Be.match(/^data:image\/[a-z]+;base64/)&&e.setAttribute("crossOrigin","anonymous"),e.src=Be},h=function(e){var t=new THREE.Texture,o=new THREE.ImageLoader,i=function(e){t.needsUpdate=!0,t.image=e,p(t)};o.load(e,i)},p=function(e){void 0!==Me.width&&(Ie.style.width=Me.width.css),void 0!==Me.height&&(Ie.style.height=Me.height.css),x(),Ae=i()?new THREE.WebGLRenderer:new THREE.CanvasRenderer,Ae.setSize(Se.width,Se.height),Le=new THREE.Scene,Oe=new THREE.PerspectiveCamera(oe,Se.ratio,1,300),Oe.position.set(0,0,0),Le.add(Oe);var o=new THREE.SphereGeometry(200,32,32),r=new THREE.MeshBasicMaterial({map:e,overdraw:!0});if(t=new THREE.Mesh(o,r),t.scale.x=-1,Le.add(t),Fe=document.createElement("div"),Fe.style.position="absolute",Fe.style.zIndex=0,He.appendChild(Fe),Ce&&(ke.setStyle(ze),ke.create(),He.appendChild(ke.getBar())),null!==nt){var a=document.createElement("img");a.onload=function(){a.style.display="block",a.style.position="absolute",a.style[nt.position.x]="5px",a.style[nt.position.y]="5px","bottom"==nt.position.y&&Ce&&(a.style.bottom=ke.getBar().offsetHeight+5+"px"),void 0!==nt.size&&(a.style.width=nt.size.width,a.style.height=nt.size.height),He.appendChild(a)},a.src=nt.image}n(window,"resize",x),Ee&&(n(Fe,"mousedown",T),n(document,"mousemove",H),n(Fe,"mousemove",G),n(document,"mouseup",P),n(Fe,"touchstart",R),n(document,"touchend",P),n(document,"touchmove",F),Te&&(n(Fe,"mousewheel",D),n(Fe,"DOMMouseScroll",D)),rt.addAction("fullscreen-mode",z)),n(document,"fullscreenchange",N),n(document,"mozfullscreenchange",N),n(document,"webkitfullscreenchange",N),n(document,"MSFullscreenChange",N),Ye.addListener(O),Ie.innerHTML="",Ie.appendChild(He);var s=Ae.domElement;s.style.display="block",Fe.appendChild(s),g(),pe>0&&X(pe),f(),U("ready")},g=function(){var e=new THREE.Vector3;e.setX(Math.cos(ce)*Math.sin(ue)),e.setY(Math.sin(ce)),e.setZ(Math.cos(ce)*Math.cos(ue)),Oe.lookAt(e),null!==De?De.render(Le,Oe):Ae.render(Le,Oe)},v=function(){De=new THREE.StereoEffect(Ae),De.eyeSeparation=Re,De.setSize(Se.width,Se.height),A(),$(),ke.mustBeHidden(),g(),U("stereo-effect",!0)},m=function(){De=null,Ae.setSize(Se.width,Se.height),ke.mustBeHidden(!1),g(),U("stereo-effect",!1)};this.toggleStereo=function(){null!==De?m():v()};var f=function(){fe!==!1&&(Ve=setTimeout(b,fe))},y=function(){ce-=(ce-xe)*we,ue+=ye;var e=!0;se||(ue=r(ue,le,de),(ue==le||ue==de)&&(be?ye*=-1:(w(),e=!1))),ue=s(ue,!0),U("position-updated",{longitude:ue,latitude:ce}),g(),e&&(Ge=setTimeout(y,me))},b=function(){y(),U("autorotate",!0)},w=function(){clearTimeout(Ve),Ve=null,clearTimeout(Ge),Ge=null,U("autorotate",!1)};this.toggleAutorotate=function(){clearTimeout(Ve),Ge?w():b()};var x=function(){(Ie.clientWidth!=Se.width||Ie.clientHeight!=Se.height)&&_({width:Ie.clientWidth,height:Ie.clientHeight})};this.fitToContainer=function(){x()};var _=function(e){Se.width=void 0!==e.width?parseInt(e.width):Se.width,Se.height=void 0!==e.height?parseInt(e.height):Se.height,Se.ratio=Se.width/Se.height,Oe&&(Oe.aspect=Se.ratio,Oe.updateProjectionMatrix()),Ae&&(Ae.setSize(Se.width,Se.height),g()),De&&(De.setSize(Se.width,Se.height),g())};this.getPosition=function(){return{longitude:ue,latitude:ce}},this.getPositionInDegrees=function(){return{longitude:180*ue/Math.PI,latitude:180*ce/Math.PI}};var k=function(e,t){var o=Y(e);se||(o=r(o,le,de));var i=Y(t);i>Math.PI&&(i-=2*Math.PI),i=r(i,ne,ie),ue=o,ce=i,U("position-updated",{longitude:ue,latitude:ce}),g()};this.moveTo=function(e,t){k(e,t)};var C=function(e,t){e=Y(e),t=Y(t),k(ue+e,ce+t)};this.rotate=function(e,t){C(e,t)};var z=function(e){var t=e?window.addEventListener:window.removeEventListener;t("keydown",S)},E=function(e){if(e.key){var t=/^Arrow/.test(e.key)?e.key:"Arrow"+e.key;return t}if(e.keyCode||e.which){var o=e.keyCode?e.keyCode:e.which,i={38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",37:"ArrowLeft"};if(void 0!==i[o])return i[o]}return""},S=function(e){var t=0,o=0;switch(console.log("test"),E(e)){case"ArrowUp":o=ee;break;case"ArrowRight":t=-Q;break;case"ArrowDown":o=-ee;break;case"ArrowLeft":t=Q}C(t,o)},T=function(e){I(parseInt(e.clientX),parseInt(e.clientY))},R=function(e){if(1==e.touches.length){var t=e.touches[0];t.target.parentNode==Fe&&I(parseInt(t.clientX),parseInt(t.clientY))}else 2==e.touches.length&&(P(),e.touches[0].target.parentNode==Fe&&e.touches[1].target.parentNode==Fe&&M(a(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY)));G()},I=function(e,t){We=e,Ne=t,w(),Xe=!0},M=function(e){qe=e,$e=!0},P=function(e){Xe=!1,$e=!1},H=function(e){e.preventDefault(),B(parseInt(e.clientX),parseInt(e.clientY))},F=function(e){if(1==e.touches.length&&Xe){var t=e.touches[0];t.target.parentNode==Fe&&(e.preventDefault(),B(parseInt(t.clientX),parseInt(t.clientY)))}else if(2==e.touches.length&&e.touches[0].target.parentNode==Fe&&e.touches[1].target.parentNode==Fe&&$e){e.preventDefault();var o=a(e.touches[0].clientX,e.touches[0].clientY,e.touches[1].clientX,e.touches[1].clientY),i=o-qe;if(0!==i){var n=i/Math.abs(i);X(pe+n),qe=o}}},B=function(e,t){Xe&&(K?(ue+=(e-We)/Se.height*ge*Math.PI/180,ce+=(t-Ne)/Se.height*ge*Math.PI/180):(ue+=(e-We)*Z,ce+=(t-Ne)*J),We=e,Ne=t,se||(ue=r(ue,le,de)),ue=s(ue,!0),ce=r(ce,ne,ie),U("position-updated",{longitude:ue,latitude:ce}),g())},A=function(){Ye.start(),w(),U("device-orientation",!0)},L=function(){Ye.stop(),U("device-orientation",!1)};this.toggleDeviceOrientation=function(){Ye.isEventAttached()?L():A()};var O=function(e){ue=r(e.longitude,le,de),ce=r(e.latitude,ne,ie),U("position-updated",{longitude:ue,latitude:ce}),g()},D=function(e){e.preventDefault(),e.stopPropagation();var t=e.detail?-e.detail:e.wheelDelta;if(0!==t){var o=parseInt(t/Math.abs(t));X(pe+o)}},X=function(e){pe=r(parseInt(Math.round(e)),0,100),ge=oe+pe/100*(te-oe),Oe.fov=ge,Oe.updateProjectionMatrix(),g(),U("zoom-updated",pe)};this.getZoomLevel=function(){return pe},this.zoom=function(e){X(e)},this.zoomIn=function(){100>pe&&X(pe+1)},this.zoomOut=function(){pe>0&&X(pe-1)};var W=function(){return!!(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},N=function(){document.webkitFullscreenElement||document.msFullscreenElement?(Pe.width=Ie.style.width,Pe.height=Ie.style.height,Ie.style.width="100%",Ie.style.height="100%",x()):(Ie.webkitRequestFullscreen||Ie.msRequestFullscreen)&&(Ie.style.width=Pe.width,Ie.style.height=Pe.height,x()),U("fullscreen-mode",W())},$=function(){Ie.requestFullscreen?Ie.requestFullscreen():Ie.mozRequestFullScreen?Ie.mozRequestFullScreen():Ie.webkitRequestFullscreen?Ie.webkitRequestFullscreen():Ie.msRequestFullscreen&&Ie.msRequestFullscreen()},q=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};this.toggleFullscreen=function(){W()?q():$()};var G=function(){Ce&&ke.show()},V=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();o.match(/(pm|per minute)$/)&&(t/=60);var i=0;switch(o){case"rpm":case"rev per minute":case"revolutions per minute":case"rps":case"rev per second":case"revolutions per second":i=2*t*Math.PI;break;case"dpm":case"deg per minute":case"degrees per minute":case"dps":case"deg per second":case"degrees per second":i=t*Math.PI/180;break;case"rad per minute":case"radians per minute":case"rad per second":case"radians per second":i=t;break;default:m_anim=!1}return i*me/1e3},Y=function(e){e=e.toString().trim();var t=parseFloat(e.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1")),o=e.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();return"deg"==o&&(t*=Math.PI/180),s(t)},j=function(e){for(var t in e)if("width"==t||"height"==t){var o=e[t].toString().trim(),i=parseFloat(o.replace(/^([0-9]+(?:\.[0-9]*)?).*$/,"$1")),n=o.replace(/^[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();"%"!=n&&(n="px"),Me[t]={css:i+n,unit:n}}};this.addAction=function(e,t){e in je||(je[e]=[]),je[e].push(t)};var U=function(e,t){if(e in je&&je[e].length)for(var o=0,i=je[e].length;i>o;++o)void 0!==t?je[e][o](t):je[e][o]()};if(void 0===e||void 0===e.panorama||void 0===e.container)return void console.log("PhotoSphereViewer: no value given for panorama or container");var K=void 0!==e.smooth_user_moves?!!e.smooth_user_moves:!0,Z=void 0!==e.long_offset?Y(e.long_offset):Math.PI/360,J=void 0!==e.lat_offset?Y(e.lat_offset):Math.PI/180,Q=void 0!==e.keyboard_long_offset?Y(e.keyboard_long_offset):Math.PI/60,ee=void 0!==e.keyboard_lat_offset?Y(e.keyboard_lat_offset):Math.PI/120,te=void 0!==e.min_fov?r(parseFloat(e.min_fov),1,179):30,oe=void 0!==e.max_fov?r(parseFloat(e.max_fov),1,179):90,ie=void 0!==e.tilt_up_max?r(Y(e.tilt_up_max),0,Math.PI/2):Math.PI/2,ne=void 0!==e.tilt_down_max?-r(Y(e.tilt_down_max),0,Math.PI/2):-Math.PI/2,re=void 0!==e.min_longitude?Y(e.min_longitude):0,ae=void 0!==e.max_longitude?Y(e.max_longitude):0,se=re==ae;se?(re=0,ae=2*Math.PI):0===ae&&(ae=2*Math.PI);var le,de;ae>re?(le=re,de=ae):(le=ae,de=re);var ce=0,ue=le;if(void 0!==e.default_position){if(void 0!==e.default_position.lat){var he=Y(e.default_position.lat);he>Math.PI&&(he-=2*Math.PI),ce=r(he,ne,ie)}void 0!==e.default_position["long"]&&(ue=r(Y(e.default_position["long"]),le,de))}var pe=0;void 0!==e.zoom_level&&(pe=r(parseInt(Math.round(e.zoom_level)),0,100));var ge=oe+pe/100*(te-oe),ve=60,me=1e3/ve,fe=2e3;void 0!==e.time_anim&&(fe="number"==typeof e.time_anim&&e.time_anim>=0?e.time_anim:!1);var ye=V(void 0!==e.anim_speed?e.anim_speed:"2rpm"),be=!0;void 0!==e.reverse_anim&&(be=!!e.reverse_anim);var we=V(void 0!==e.vertical_anim_speed?e.vertical_anim_speed:"2rpm"),xe=0;if(void 0!==e.vertical_anim_target){var _e=Y(e.vertical_anim_target);_e>Math.PI&&(_e-=2*Math.PI),xe=r(_e,ne,ie)}var ke=new PSVNavBar(this),Ce=void 0!==e.navbar?!!e.navbar:!1,ze=void 0!==e.navbar_style?e.navbar_style:{},Ee=void 0!==e.allow_user_interactions?!!e.allow_user_interactions:!0;Ee||(Ce=!1);var Se,Te=void 0!==e.allow_scroll_to_zoom?!!e.allow_scroll_to_zoom:!0,Re=void 0!==e.eyes_offset?parseFloat(e.eyes_offset):5,Ie="string"==typeof e.container?document.getElementById(e.container):e.container,Me={},Pe={};void 0!==e.size&&j(e.size);var He,Fe,Be=e.panorama,Ae=null,Le=null,Oe=null,De=null,Xe=!1,We=0,Ne=0,$e=!1,qe=0,Ge=null,Ve=null,Ye=new Sphoords,je={},Ue=void 0!==e.usexmpdata?!!e.usexmpdata:!0,Ke=void 0!==e.cors_anonymous?!!e.cors_anonymous:!0,Ze={full_width:null,full_height:null,cropped_width:null,cropped_height:null,cropped_x:null,cropped_y:null};if(void 0!==e.pano_size){for(var Je in Ze)void 0!==e.pano_size[Je]&&(Ze[Je]=parseInt(e.pano_size[Je]));Ue=!1}var Qe={horizontal_fov:360,vertical_fov:180};if(void 0!==e.captured_view){for(var Je in Qe)void 0!==e.captured_view[Je]&&(Qe[Je]=parseFloat(e.captured_view[Je]));Ue=!1}var et=!1,tt=void 0!==e.loading_msg?e.loading_msg.toString():"Loading…",ot=void 0!==e.loading_img?e.loading_img.toString():null,it=void 0!==e.loading_html?e.loading_html:null,nt=null;void 0!==e.overlay&&void 0!==e.overlay.image&&(nt={image:e.overlay.image,position:{x:"left",y:"bottom"}},void 0!==e.overlay.position&&(void 0===e.overlay.position.x||"left"!=e.overlay.position.x&&"right"!=e.overlay.position.x||(nt.position.x=e.overlay.position.x),void 0===e.overlay.position.y||"top"!=e.overlay.position.y&&"bottom"!=e.overlay.position.y||(nt.position.y=e.overlay.position.y)),void 0!==e.overlay.size&&(nt.size={width:void 0!==e.overlay.size.width?e.overlay.size.width:"auto",height:void 0!==e.overlay.size.height?e.overlay.size.height:"auto"}));var rt=this;void 0!==e.onready&&this.addAction("ready",e.onready);var at=void 0!==e.autoload?!!e.autoload:!0;at&&this.load()},PSVNavBar=function(e){var t=function(e,t){for(var o=0,i=t.length;i>o;++o)if(t[o]==e)return!0;return!1},o=function(e,o){return t(e,h)&&"string"==typeof o&&("transparent"==o||!!o.match(/^#([0-9A-Fa-f]{3}|[0-9A-Fa-f]{6})$/)||!!o.match(/^rgb\((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])(,\s*(1?[0-9]{1,2}|2[0-4][0-9]|25[0-5])){2}\)$/)||!!o.match(/^rgba\(((1?[0-9]{1,2}|2[0-4][0-9]|25[0-5]),\s*){3}(0(\.[0-9]*)?|1)\)$/))||t(e,p)&&!isNaN(parseFloat(o))&&isFinite(o)&&o>=0};this.setStyle=function(e){for(var t in e)t in u&&o(t,e[t])&&(u[t]=e[t])},this.create=function(){r=document.createElement("div"),r.style.backgroundColor=u.backgroundColor,r.style.position="absolute",r.style.zIndex=10,r.style.bottom=0,r.style.width="100%",r.style.boxSizing="content-box",r.style.transition="bottom 0.4s ease-out",a=new PSVNavBarButton(e,"autorotate",u),r.appendChild(a.getButton()),s=new PSVNavBarButton(e,"zoom",u),r.appendChild(s.getButton()),l=new PSVNavBarButton(e,"fullscreen",u),r.appendChild(l.getButton()),Sphoords.isDeviceOrientationSupported&&(d=new PSVNavBarButton(e,"orientation",u),r.appendChild(d.getButton()),c=new PSVNavBarButton(e,"virtual-reality",u),r.appendChild(c.getButton()))},this.getBar=function(){return r};var i=function(){g&&(clearTimeout(g),!v&&m&&(g=setTimeout(n,5e3))),v&&(r.style.bottom=0,v=!1,m&&(g=setTimeout(n,5e3)))};this.show=function(){i()};var n=function(){v||(r.style.bottom=-r.offsetHeight+1+"px",v=!0)};this.hide=function(){n()},this.isHidden=function(){return v},this.mustBeHidden=function(e){m=void 0!==e?!!e:!0,m?n():i()};var r,a,s,l,d,c,u={backgroundColor:"rgba(61, 61, 61, 0.5)",buttonsColor:"rgba(255, 255, 255, 0.7)",buttonsBackgroundColor:"transparent",activeButtonsBackgroundColor:"rgba(255, 255, 255, 0.1)",buttonsHeight:20,autorotateThickness:1,zoomRangeWidth:50,zoomRangeThickness:1,zoomRangeDisk:7,fullscreenRatio:4/3,fullscreenThickness:2,gyroscopeThickness:1,virtualRealityRatio:4/3,virtualRealityBorderRadius:2},h=["backgroundColor","buttonsColor","buttonsBackgroundColor","activeButtonsBackgroundColor"],p=["buttonsHeight","autorotateThickness","zoomRangeWidth","zoomRangeThickness","zoomRangeDisk","fullscreenRatio","fullscreenThickness"],g=null,v=!1,m=!1},PSVNavBarButton=function(e,t,o){var i=function(e,t,o){e.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o)},n=function(){switch(t){case"autorotate":var n=o.buttonsHeight-2*o.autorotateThickness,p=n/10;l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=o.buttonsHeight+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",i(l,"click",function(){e.toggleAutorotate()});var f=document.createElement("div");f.style.boxSizing="inherit",f.style.width=n+"px",f.style.height=n+"px",f.style.borderRadius="50%",f.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,l.appendChild(f);var y=document.createElement("div");y.style.boxSizing="inherit",y.style.width=n+"px",y.style.height=p+"px",y.style.borderRadius="50%",y.style.border=o.autorotateThickness+"px solid "+o.buttonsColor,y.style.position="absolute",y.style.top="50%",y.style.marginTop=-(p/2+o.autorotateThickness)+"px",l.appendChild(y),e.addAction("autorotate",d);break;case"zoom":l=document.createElement("div"),l.style.cssFloat="left",l.style.boxSizing="inherit";var b=document.createElement("div");b.style.cssFloat="left",b.style.boxSizing="inherit",b.style.padding="10px",b.style.height=o.buttonsHeight+"px",b.style.backgroundColor=o.buttonsBackgroundColor,b.style.lineHeight=o.buttonsHeight+"px",b.style.color=o.buttonsColor,b.style.cursor="pointer",b.textContent="-",i(b,"click",function(){e.zoomOut()}),l.appendChild(b),r=document.createElement("div"),r.style.cssFloat="left",r.style.boxSizing="inherit",r.style.padding=10+(o.buttonsHeight-o.zoomRangeThickness)/2+"px 5px",r.style.backgroundColor=o.buttonsBackgroundColor,r.style.cursor="pointer",l.appendChild(r),a=document.createElement("div"),a.style.boxSizing="inherit",a.style.width=o.zoomRangeWidth+"px",a.style.height=o.zoomRangeThickness+"px",a.style.backgroundColor=o.buttonsColor,a.style.position="relative",r.appendChild(a),s=document.createElement("div"),s.style.position="absolute",s.style.top=(o.zoomRangeThickness-o.zoomRangeDisk)/2+"px",s.style.left=-(o.zoomRangeDisk/2)+"px",s.style.boxSizing="inherit",s.style.width=o.zoomRangeDisk+"px",s.style.height=o.zoomRangeDisk+"px",s.style.borderRadius="50%",s.style.backgroundColor=o.buttonsColor,e.addAction("zoom-updated",c),i(r,"mousedown",u),i(r,"touchstart",h),i(document,"mousemove",v),i(document,"touchmove",m),i(document,"mouseup",g),i(document,"touchend",g),a.appendChild(s);var w=document.createElement("div");w.style.cssFloat="left",w.style.boxSizing="inherit",w.style.padding="10px",w.style.height=o.buttonsHeight+"px",w.style.backgroundColor=o.buttonsBackgroundColor,w.style.lineHeight=o.buttonsHeight+"px",w.style.color=o.buttonsColor,w.style.cursor="pointer",w.textContent="+",i(w,"click",function(){e.zoomIn()}),l.appendChild(w);break;case"fullscreen":var x=o.buttonsHeight*o.fullscreenRatio,_=.3*o.buttonsHeight,k=(o.buttonsHeight-_)/2,C=.3*x,z=(x-C)/2-o.fullscreenThickness,E=o.buttonsHeight-2*o.fullscreenThickness;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=x+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.cursor="pointer",i(l,"click",function(){e.toggleFullscreen()});var S=document.createElement("div");S.style.cssFloat="left",S.style.boxSizing="inherit",S.style.width=o.fullscreenThickness+"px",S.style.height=_+"px",S.style.borderStyle="solid",S.style.borderColor=o.buttonsColor+" transparent",S.style.borderWidth=k+"px 0",l.appendChild(S);var T=document.createElement("div");T.style.cssFloat="left",T.style.boxSizing="inherit",T.style.width=z+"px",T.style.height=E+"px",T.style.borderStyle="solid",T.style.borderColor=o.buttonsColor+" transparent",T.style.borderWidth=o.fullscreenThickness+"px 0",l.appendChild(T);var R=document.createElement("div");R.style.cssFloat="left",R.style.boxSizing="inherit",R.style.marginLeft=C+"px",R.style.width=z+"px",R.style.height=E+"px",R.style.borderStyle="solid",R.style.borderColor=o.buttonsColor+" transparent",R.style.borderWidth=o.fullscreenThickness+"px 0",l.appendChild(R);var I=document.createElement("div");I.style.cssFloat="left",I.style.boxSizing="inherit",I.style.width=o.fullscreenThickness+"px",I.style.height=_+"px",I.style.borderStyle="solid",I.style.borderColor=o.buttonsColor+" transparent",I.style.borderWidth=k+"px 0",l.appendChild(I);var M=document.createElement("div");M.style.clear="left",l.appendChild(M),e.addAction("fullscreen-mode",d);break;case"orientation":var P=o.buttonsHeight-2*o.gyroscopeThickness,H=P-4*o.gyroscopeThickness,F=P/10;l=document.createElement("div"),l.style.cssFloat="right",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=o.buttonsHeight+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.position="relative",l.style.cursor="pointer",i(l,"click",function(){e.toggleDeviceOrientation()});var B=document.createElement("div");B.style.boxSizing="inherit",B.style.width=P+"px",B.style.height=P+"px",B.style.borderRadius="50%",B.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,l.appendChild(B);var A=document.createElement("div");A.style.boxSizing="inherit",A.style.width=H+"px",A.style.height=F+"px",A.style.borderRadius="50%",A.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,A.style.position="absolute",A.style.top="50%",A.style.left="50%",A.style.marginTop=-(F/2+o.gyroscopeThickness)+"px",A.style.marginLeft=-(H/2+o.gyroscopeThickness)+"px",l.appendChild(A);var L=document.createElement("div");L.style.boxSizing="inherit",L.style.width=F+"px",L.style.height=H+"px",L.style.borderRadius="50%",L.style.border=o.gyroscopeThickness+"px solid "+o.buttonsColor,L.style.position="absolute",L.style.top="50%",L.style.left="50%",L.style.marginTop=-(H/2+o.gyroscopeThickness)+"px",L.style.marginLeft=-(F/2+o.gyroscopeThickness)+"px",l.appendChild(L),e.addAction("device-orientation",d);break;case"virtual-reality":var O=o.buttonsHeight*o.virtualRealityRatio,D=O/4,X=D/2;l=document.createElement("div"),l.style.cssFloat="right",l.style.position="relative",l.style.boxSizing="inherit",l.style.padding="10px",l.style.width=O+"px",l.style.height=o.buttonsHeight+"px",l.style.backgroundColor=o.buttonsBackgroundColor,l.style.cursor="pointer",i(l,"click",function(){e.toggleStereo()});var W=document.createElement("div");W.style.boxSizing="inherit",W.style.width=O+"px",W.style.height=o.buttonsHeight+"px",W.style.borderRadius=o.virtualRealityBorderRadius+"px",W.style.backgroundColor=o.buttonsColor,l.appendChild(W);var N=document.createElement("div");N.style.boxSizing="inherit",N.style.width=D+"px",N.style.height=D+"px",N.style.position="absolute",N.style.top=X+10+"px",N.style.left=X+10+"px",N.style.borderRadius="50%",N.style.backgroundColor=o.backgroundColor,l.appendChild(N);var $=document.createElement("div");$.style.boxSizing="inherit",$.style.width=D+"px",$.style.height=D+"px",$.style.position="absolute",$.style.top=X+10+"px",$.style.right=X+10+"px",$.style.borderRadius="50%",$.style.backgroundColor=o.backgroundColor,l.appendChild($);var q=document.createElement("div");q.style.boxSizing="inherit",q.style.width=D+"px",q.style.height=o.buttonsHeight/2+"px",q.style.position="absolute",q.style.left="50%",q.style.bottom="10px",q.style.marginLeft=-(D/2)+"px",q.style.borderTopLeftRadius="50% 60%",q.style.borderTopRightRadius="50% 60%",q.style.backgroundColor=o.backgroundColor,l.appendChild(q),e.addAction("stereo-effect",d)}};this.getButton=function(){return l};var r,a,s,l,d=function(e){e?l.style.backgroundColor=o.activeButtonsBackgroundColor:l.style.backgroundColor=o.buttonsBackgroundColor},c=function(e){s.style.left=e/100*o.zoomRangeWidth-o.zoomRangeDisk/2+"px"},u=function(e){p(parseInt(e.clientX))},h=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&p(parseInt(t.clientX))},p=function(e){y=!0,f(e)},g=function(e){y=!1},v=function(e){e.preventDefault(),f(parseInt(e.clientX))},m=function(e){var t=e.touches[0];(t.target==r||t.target==a||t.target==s)&&(e.preventDefault(),f(parseInt(t.clientX)))},f=function(t){if(y){var i=t-a.getBoundingClientRect().left,n=i/o.zoomRangeWidth*100;e.zoom(n)}},y=!1;n()},Sphoords=function(){var e=function(){var e=navigator.userAgent;return/Gecko\/[0-9.]+/.test(e)?"Gecko":/Chrome\/[0-9.]+/.test(e)?"Blink":/AppleWebKit\/[0-9.]+/.test(e)?"WebKit":/Trident\/[0-9.]+/.test(e)?"Trident":/Opera\/[0-9.]+/.test(e)?"Presto":"Gecko"},t=function(e){return e-360*Math.floor(e/360)};this.start=function(){return Sphoords.isDeviceOrientationSupported?(window.addEventListener("deviceorientation",o,!1),n=!0,!0):(console.log("Device Orientation API not supported"),!1)},this.stop=function(){n&&(window.removeEventListener("deviceorientation",o,!1),n=!1)},this.toggle=function(){n?this.stop():this.start()},this.isEventAttached=function(){return n};var o=function(e){c=Sphoords.getScreenOrientation();var o=0,n=0;switch(c){case"portrait-primary":o=e.alpha+e.gamma,n=e.beta-90;break;case"landscape-primary":if(o=e.alpha+e.beta-90,n=-e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":n+=180;break;case"Gecko":default:n=-n}"WebKit"===u&&window.orientation&&(0>n&&(n=-1*(n+180)),o>=180?o-=180:o+=180);break;case"landscape-secondary":if(o=e.alpha-e.beta+90,n=e.gamma-90,Math.abs(e.beta)>90)switch(u){case"Blink":n+=180;break;case"Gecko":default:n=-n}"WebKit"===u&&window.orientation&&(0>n&&(n=-1*(n+180)),o>=180?o-=180:o+=180);break;case"portrait-secondary":o=e.alpha-e.gamma,n=180-(e.beta-90),n=270-e.beta}n=t(n),n>=180&&(n-=360),r=t(o),a=Math.max(-90,Math.min(90,n)),s=r*d,l=a*d,i()};this.getCoordinates=function(){return{longitude:s,latitude:l}},this.getCoordinatesInDegrees=function(){return{longitude:r,latitude:a}},this.getScreenOrientation=function(){return c},this.addListener=function(e){h.push(e)};var i=function(){if(h.length)for(var e=0,t=h.length;t>e;++e)h[e]({longitude:s,latitude:l})},n=!1,r=0,a=0,s=0,l=0,d=Math.PI/180,c=Sphoords.getScreenOrientation(),u=e(),h=[]};Sphoords.getScreenOrientation=function(){var e=null;if(screen.orientation)e=screen.orientation;else if(screen.mozOrientation)e=screen.mozOrientation;else if(screen.msOrientation)e=screen.msOrientation;else if(window.orientation||0===window.orientation)switch(window.orientation){case 0:e="portrait-primary";break;case 180:e="portrait-secondary";break;case-90:e="landscape-primary";break;case 90:e="landscape-secondary"}return null!==e&&"object"==typeof e?e.type:e},Sphoords.isDeviceOrientationSupported=!1,function(){function e(t){null!==t&&null!==t.alpha&&(Sphoords.isDeviceOrientationSupported=!0,window.removeEventListener("deviceorientation",e))}window.DeviceOrientationEvent&&null!==Sphoords.getScreenOrientation()&&window.addEventListener("deviceorientation",e)}();